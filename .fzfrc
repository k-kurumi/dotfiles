# vim: set ft=sh :
# fzfを使ったショートカットなど

# フォルダは移動する
# ファイルはvimで開く
fzf_open_file() {
  local selected=$(find . -not -path './.git/*' -print 2> /dev/null | fzf)
  echo $selected
  if [ -n "$selected" ]; then
    if [[ -d "$selected" ]]; then
      BUFFER="cd ${selected}"
    else
      BUFFER="vim ${selected}"
    fi
    zle accept-line
  fi
  zle clear-screen
}
zle -N fzf_open_file
bindkey '^O' fzf_open_file

# history表示
function fzf_select_history() {
  BUFFER=$(history -n 1 | fzf)
  zle clear-screen
}
zle -N fzf_select_history
bindkey '^R' fzf_select_history

# ghqリポジトリに移動する
function fzf_select_ghq_repo() {
  local selected_dir=$(ghq list -p | fzf)
  echo $selected_dir
  if [ -n "$selected_dir" ]; then
    BUFFER="cd ${selected_dir}"
    zle accept-line
  fi
  zle clear-screen
}
zle -N fzf_select_ghq_repo
bindkey '^G' fzf_select_ghq_repo
